<UserControl x:Class="WallpaperEngine.Views.MyToolBar"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d">
    <ToolBar Background="#F0F0F0">
        <StackPanel Orientation="Horizontal" Margin="5">
            <!-- 搜索区域 -->
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="搜索:" VerticalAlignment="Center"/>
                <TextBox Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}" 
                         KeyDown="TextBox_KeyDown" 
                         VerticalAlignment="Center" 
                         Width="200" 
                         Margin="5,0"/>
            </StackPanel>
            <!-- 分类筛选 -->
            <ComboBox ItemsSource="{Binding Categories}" 
                      SelectedItem="{Binding SelectedCategory}" 
                      Width="100" Margin="5,0"/>
            <!-- 收藏筛选 -->
            <CheckBox Content="仅显示收藏" 
                      IsChecked="{Binding ShowFavoritesOnly}" 
                      ToolTip="只显示已收藏的壁纸"/>

            <Separator/>
            <!-- 扫描按钮组 -->
            <Button Content="📁 扫描壁纸" 
                    Command="{Binding ScanWallpapersCommand}" 
                    Margin="5,0" 
                    ToolTip="扫描壁纸文件夹"/>
            <Button Content="⚡ 快速增量扫描" 
                    Command="{Binding QuickIncrementalScanCommand}" 
                    Margin="5,0" 
                    ToolTip="对上次扫描的文件夹进行增量扫描" 
                    Background="#4CAF50" 
                    Foreground="White"/>
            <Button Content="❌ 取消" 
                    Command="{Binding CancelScanCommand}" 
                    Margin="5,0" 
                    ToolTip="取消当前扫描" 
                    Background="#F44336" 
                    Foreground="White" 
                    Visibility="{Binding IsScanning, Converter={StaticResource BooleanToVisibilityConverter}}"/>

            <Separator Margin="10,0"/>
            <!-- 扫描模式选择 -->
            <CheckBox Content="启用增量扫描" 
                      IsChecked="{Binding UseIncrementalScan}" 
                      VerticalAlignment="Center" 
                      Margin="5,0" 
                      ToolTip="增量扫描只处理新增或修改的文件，速度更快"/>

            <Separator Margin="10,0"/>
            <!-- 扫描状态显示 -->
            <StackPanel Orientation="Vertical" Margin="10,0" Width="300">
                <TextBlock Text="{Binding ScanStatus}" FontWeight="Bold" TextWrapping="Wrap"/>
                <ProgressBar Value="{Binding ScanProgress}" Height="10" 
                           Visibility="{Binding IsScanning, Converter={StaticResource BooleanToVisibilityConverter}}" 
                           Margin="0,5"/>
                <StackPanel Orientation="Horizontal" Margin="0,5">
                    <TextBlock Text="新增:" Foreground="Green" Margin="0,0,5,0"/>
                    <TextBlock Text="{Binding NewFoundCount}"/>
                    <TextBlock Text="更新:" Foreground="Blue" Margin="10,0,5,0"/>
                    <TextBlock Text="{Binding UpdatedCount}"/>
                    <TextBlock Text="跳过:" Foreground="Gray" Margin="10,0,5,0"/>
                    <TextBlock Text="{Binding SkippedCount}"/>
                </StackPanel>
            </StackPanel>
            <!-- 设置按钮 -->
            <Button Content="⚙️ 设置" 
                    Command="{Binding OpenSettingsCommand}" 
                    Width="80" Height="35" 
                    ToolTip="设置" 
                    Style="{StaticResource MaterialDesignOutlinedButton}">
                <Button.ContentTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="设置" Margin="5,0,0,0"/>
                        </StackPanel>
                    </DataTemplate>
                </Button.ContentTemplate>
            </Button>
        </StackPanel>
    </ToolBar>
</UserControl>