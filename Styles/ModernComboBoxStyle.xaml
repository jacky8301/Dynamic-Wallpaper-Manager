<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <!-- ModernComboBox 样式 -->
        <Style x:Key="ModernComboBox" TargetType="ComboBox">
            <Setter Property="Background" Value="#FFFFFF"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto"/>
            <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid x:Name="MainGrid">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="20"/>
                            </Grid.ColumnDefinitions>

                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="CommonStates">
                                    <VisualState x:Name="Normal"/>
                                    <VisualState x:Name="MouseOver">
                                        <Storyboard>
                                            <ColorAnimation Duration="0:0:0.2" 
                                                       Storyboard.TargetName="Border"
                                                       Storyboard.TargetProperty="BorderBrush.Color" 
                                                       To="#4CAF50"/>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Pressed"/>
                                    <VisualState x:Name="Disabled">
                                        <Storyboard>
                                            <ColorAnimation Duration="0:0:0.2" 
                                                       Storyboard.TargetName="Border"
                                                       Storyboard.TargetProperty="Background.Color" 
                                                       To="#F5F5F5"/>
                                            <ColorAnimation Duration="0:0:0.2" 
                                                       Storyboard.TargetName="ContentPresenter"
                                                       Storyboard.TargetProperty="Foreground.Color" 
                                                       To="#999999"/>
                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup>
                                <VisualStateGroup x:Name="FocusStates">
                                    <VisualState x:Name="Focused">
                                        <Storyboard>
                                            <ColorAnimation Duration="0:0:0.2" 
                                                       Storyboard.TargetName="Border"
                                                       Storyboard.TargetProperty="BorderBrush.Color" 
                                                       To="#2196F3"/>
                                            <DoubleAnimation Duration="0:0:0.2" 
                                                        Storyboard.TargetName="Border"
                                                        Storyboard.TargetProperty="BorderThickness" 
                                                        To="2"/>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="Unfocused"/>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>

                            <!-- 边框和背景 -->
                            <Border x:Name="Border" 
                                Grid.ColumnSpan="2" 
                                CornerRadius="4"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                Background="{TemplateBinding Background}"/>

                            <!-- 内容显示 -->
                            <ContentPresenter x:Name="ContentPresenter"
                                        Grid.Column="0"
                                        Content="{TemplateBinding SelectionBoxItem}"
                                        ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                        ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                        Margin="{TemplateBinding Padding}"
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Center"/>

                            <!-- 下拉箭头 -->
                            <Path x:Name="Arrow"
                            Grid.Column="1"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Data="M0,0 L4,4 L8,0 Z"
                            Fill="#666666"
                            Stretch="Uniform"/>

                            <!-- 下拉弹出框 -->
                            <Popup x:Name="Popup"
                            Grid.ColumnSpan="2"
                            Placement="Bottom"
                            IsOpen="{Binding IsDropDownOpen, RelativeSource={RelativeSource TemplatedParent}}"
                            AllowsTransparency="True"
                            Focusable="False"
                            PopupAnimation="Slide">

                                <Border x:Name="DropDownBorder"
                                    CornerRadius="4"
                                    BorderThickness="1"
                                    BorderBrush="#E0E0E0"
                                    Background="White"
                                    Effect="{StaticResource DropShadowEffect}">

                                    <ScrollViewer x:Name="ScrollViewer" 
                                            MaxHeight="{TemplateBinding MaxDropDownHeight}"
                                            SnapsToDevicePixels="True">
                                        <ItemsPresenter/>
                                    </ScrollViewer>
                                </Border>
                            </Popup>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ComboBoxItem 的现代化样式 -->
        <Style x:Key="ModernComboBoxItem" TargetType="ComboBoxItem">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBoxItem">
                        <Border x:Name="Border" 
                            Background="{TemplateBinding Background}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Padding="{TemplateBinding Padding}">

                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="SelectionStates">
                                    <VisualState x:Name="Unselected"/>
                                    <VisualState x:Name="Selected">
                                        <Storyboard>
                                            <ColorAnimation Duration="0:0:0.1" 
                                                       Storyboard.TargetName="Border"
                                                       Storyboard.TargetProperty="Background.Color" 
                                                       To="#E3F2FD"/>
                                        </Storyboard>
                                    </VisualState>
                                    <VisualState x:Name="SelectedUnfocused">
                                        <Storyboard>
                                            <ColorAnimation Duration="0:0:0.1" 
                                                       Storyboard.TargetName="Border"
                                                       Storyboard.TargetProperty="Background.Color" 
                                                       To="#F5F5F5"/>
                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup>
                                <VisualStateGroup x:Name="CommonStates">
                                    <VisualState x:Name="Normal"/>
                                    <VisualState x:Name="MouseOver">
                                        <Storyboard>
                                            <ColorAnimation Duration="0:0:0.1" 
                                                       Storyboard.TargetName="Border"
                                                       Storyboard.TargetProperty="Background.Color" 
                                                       To="#F5F5F5"/>
                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>

                            <ContentPresenter/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- 阴影效果（如果尚未定义） -->
        <DropShadowEffect x:Key="DropShadowEffect" 
                     BlurRadius="10" 
                     ShadowDepth="2" 
                     Opacity="0.1" 
                     Color="#000000"/>
</ResourceDictionary>